{
	"$schema": "http://json-schema.org/draft-07/schema#",
	"title": "Gemini CLI Settings",
	"description": "Configuration schema for Gemini CLI settings.json files.",
	"type": "object",
	"properties": {
		"mcpServers": {
			"type": "object",
			"description": "Configuration for MCP servers.",
			"additionalProperties": {
				"$ref": "#/definitions/MCPServerConfig"
			}
		},
		"general": {
			"type": "object",
			"properties": {
				"preferredEditor": {
					"type": "string",
					"description": "The preferred editor to open files in."
				},
				"vimMode": {
					"type": "boolean",
					"description": "Enable Vim keybindings"
				},
				"disableAutoUpdate": {
					"type": "boolean",
					"description": "Disable automatic updates"
				},
				"disableUpdateNag": {
					"type": "boolean",
					"description": "Disable update notification prompts."
				},
				"checkpointing": {
					"type": "object",
					"properties": {
						"enabled": {
							"type": "boolean",
							"description": "Enable session checkpointing for recovery"
						}
					}
				},
				"enablePromptCompletion": {
					"type": "boolean",
					"description": "Enable AI-powered prompt completion suggestions while typing."
				},
				"retryFetchErrors": {
					"type": "boolean",
					"description": "Retry on \"exception TypeError: fetch failed sending request\" errors."
				},
				"debugKeystrokeLogging": {
					"type": "boolean",
					"description": "Enable debug logging of keystrokes to the console."
				},
				"sessionRetention": {
					"type": "object",
					"description": "Settings for automatic session cleanup.",
					"properties": {
						"enabled": {
							"type": "boolean",
							"description": "Enable automatic session cleanup"
						},
						"maxAge": {
							"type": "string",
							"description": "Maximum age of sessions to keep (e.g., \"30d\", \"7d\", \"24h\", \"1w\")"
						},
						"maxCount": {
							"type": "number",
							"description": "Alternative: Maximum number of sessions to keep (most recent)"
						},
						"minRetention": {
							"type": "string",
							"description": "Minimum retention period (safety limit, defaults to \"1d\")"
						}
					}
				}
			}
		},
		"output": {
			"type": "object",
			"properties": {
				"format": {
					"type": "string",
					"enum": ["text", "json"],
					"description": "The format of the CLI output."
				}
			}
		},
		"ui": {
			"type": "object",
			"properties": {
				"theme": {
					"type": "string",
					"description": "The color theme for the UI. See the CLI themes guide for available options."
				},
				"customThemes": {
					"type": "object",
					"description": "Custom theme definitions.",
					"additionalProperties": {
						"$ref": "#/definitions/CustomTheme"
					}
				},
				"hideWindowTitle": {
					"type": "boolean",
					"description": "Hide the window title bar"
				},
				"showStatusInTitle": {
					"type": "boolean",
					"description": "Show Gemini CLI status and thoughts in the terminal window title"
				},
				"hideTips": {
					"type": "boolean",
					"description": "Hide helpful tips in the UI"
				},
				"hideBanner": {
					"type": "boolean",
					"description": "Hide the application banner"
				},
				"hideContextSummary": {
					"type": "boolean",
					"description": "Hide the context summary (GEMINI.md, MCP servers) above the input."
				},
				"footer": {
					"type": "object",
					"properties": {
						"hideCWD": {
							"type": "boolean",
							"description": "Hide the current working directory path in the footer."
						},
						"hideSandboxStatus": {
							"type": "boolean",
							"description": "Hide the sandbox status indicator in the footer."
						},
						"hideModelInfo": {
							"type": "boolean",
							"description": "Hide the model name and context usage in the footer."
						},
						"hideContextPercentage": {
							"type": "boolean",
							"description": "Hides the context window remaining percentage."
						}
					}
				},
				"hideFooter": {
					"type": "boolean",
					"description": "Hide the footer from the UI"
				},
				"showMemoryUsage": {
					"type": "boolean",
					"description": "Display memory usage information in the UI"
				},
				"showLineNumbers": {
					"type": "boolean",
					"description": "Show line numbers in the chat."
				},
				"showCitations": {
					"type": "boolean",
					"description": "Show citations for generated text in the chat."
				},
				"useFullWidth": {
					"type": "boolean",
					"description": "Use the entire width of the terminal for output."
				},
				"useAlternateBuffer": {
					"type": "boolean",
					"description": "Use an alternate screen buffer for the UI, preserving shell history."
				},
				"customWittyPhrases": {
					"type": "array",
					"description": "Custom witty phrases to display during loading. When provided, the CLI cycles through these instead of the defaults.",
					"items": {
						"type": "string"
					}
				},
				"accessibility": {
					"type": "object",
					"properties": {
						"disableLoadingPhrases": {
							"type": "boolean",
							"description": "Disable loading phrases for accessibility"
						},
						"screenReader": {
							"type": "boolean",
							"description": "Render output in plain-text to be more screen reader accessible"
						}
					}
				}
			}
		},
		"ide": {
			"type": "object",
			"properties": {
				"enabled": {
					"type": "boolean",
					"description": "Enable IDE integration mode"
				},
				"hasSeenNudge": {
					"type": "boolean",
					"description": "Whether the user has seen the IDE integration nudge."
				}
			}
		},
		"privacy": {
			"type": "object",
			"properties": {
				"usageStatisticsEnabled": {
					"type": "boolean",
					"description": "Enable collection of usage statistics"
				}
			}
		},
		"telemetry": {
			"$ref": "#/definitions/TelemetrySettings",
			"description": "Telemetry configuration."
		},
		"model": {
			"type": "object",
			"properties": {
				"name": {
					"type": "string",
					"description": "The Gemini model to use for conversations."
				},
				"maxSessionTurns": {
					"type": "number",
					"description": "Maximum number of user/model/tool turns to keep in a session. -1 means unlimited."
				},
				"summarizeToolOutput": {
					"type": "object",
					"description": "Enables or disables summarization of tool output. Configure per-tool token budgets (for example {\"run_shell_command\": {\"tokenBudget\": 2000}}). Currently only the run_shell_command tool supports summarization.",
					"additionalProperties": {
						"$ref": "#/definitions/SummarizeToolOutputSettings"
					}
				},
				"compressionThreshold": {
					"type": "number",
					"description": "The fraction of context usage at which to trigger context compression (e.g. 0.2, 0.3)."
				},
				"skipNextSpeakerCheck": {
					"type": "boolean",
					"description": "Skip the next speaker check."
				}
			}
		},
		"modelConfigs": {
			"type": "object",
			"description": "Model configurations.",
			"properties": {
				"aliases": {
					"type": "object",
					"description": "Named presets for model configs. Can be used in place of a model name and can inherit from other aliases using an `extends` property."
				},
				"overrides": {
					"type": "array",
					"description": "Apply specific configuration overrides based on matches, with a primary key of model (or alias). The most specific match will be used."
				}
			}
		},
		"context": {
			"type": "object",
			"properties": {
				"fileName": {
					"$ref": "#/definitions/StringOrStringArray",
					"description": "The name of the context file or files to load into memory. Accepts either a single string or an array of strings."
				},
				"importFormat": {
					"type": "string",
					"description": "The format to use when importing memory."
				},
				"discoveryMaxDirs": {
					"type": "number",
					"description": "Maximum number of directories to search for memory."
				},
				"includeDirectories": {
					"type": "array",
					"description": "Additional directories to include in the workspace context. Missing directories will be skipped with a warning.",
					"items": {
						"type": "string"
					}
				},
				"loadMemoryFromIncludeDirectories": {
					"type": "boolean",
					"description": "Controls how /memory refresh loads GEMINI.md files. When true, include directories are scanned; when false, only the current directory is used."
				},
				"fileFiltering": {
					"type": "object",
					"description": "Settings for git-aware file filtering.",
					"properties": {
						"respectGitIgnore": {
							"type": "boolean",
							"description": "Respect .gitignore files when searching"
						},
						"respectGeminiIgnore": {
							"type": "boolean",
							"description": "Respect .geminiignore files when searching"
						},
						"enableRecursiveFileSearch": {
							"type": "boolean",
							"description": "Enable recursive file search functionality when completing @ references in the prompt."
						},
						"disableFuzzySearch": {
							"type": "boolean",
							"description": "Disable fuzzy search when searching for files."
						}
					}
				}
			}
		},
		"tools": {
			"type": "object",
			"properties": {
				"sandbox": {
					"$ref": "#/definitions/BooleanOrString",
					"description": "Sandbox execution environment. Set to a boolean to enable or disable the sandbox, or provide a string path to a sandbox profile."
				},
				"shell": {
					"type": "object",
					"properties": {
						"enableInteractiveShell": {
							"type": "boolean",
							"description": "Use node-pty for an interactive shell experience. Fallback to child_process still applies."
						},
						"pager": {
							"type": "string",
							"description": "The pager command to use for shell output. Defaults to `cat`."
						},
						"showColor": {
							"type": "boolean",
							"description": "Show color in shell output."
						}
					}
				},
				"autoAccept": {
					"type": "boolean",
					"description": "Automatically accept and execute tool calls that are considered safe (e.g., read-only operations)."
				},
				"core": {
					"type": "array",
					"description": "Restrict the set of built-in tools with an allowlist. Match semantics mirror tools.allowed; see the built-in tools documentation for available names.",
					"items": {
						"type": "string"
					}
				},
				"allowed": {
					"type": "array",
					"description": "Tool names that bypass the confirmation dialog. Useful for trusted commands (for example [\"run_shell_command(git)\", \"run_shell_command(npm test)\"]). See shell tool command restrictions for matching details.",
					"items": {
						"type": "string"
					}
				},
				"exclude": {
					"type": "array",
					"description": "Tool names to exclude from discovery.",
					"items": {
						"type": "string"
					}
				},
				"discoveryCommand": {
					"type": "string",
					"description": "Command to run for tool discovery."
				},
				"callCommand": {
					"type": "string",
					"description": "Defines a custom shell command for invoking discovered tools. The command must take the tool name as the first argument, read JSON arguments from stdin, and emit JSON results on stdout."
				},
				"useRipgrep": {
					"type": "boolean",
					"description": "Use ripgrep for file content search instead of the fallback implementation. Provides faster search performance."
				},
				"enableToolOutputTruncation": {
					"type": "boolean",
					"description": "Enable truncation of large tool outputs."
				},
				"truncateToolOutputThreshold": {
					"type": "number",
					"description": "Truncate tool output if it is larger than this many characters. Set to -1 to disable."
				},
				"truncateToolOutputLines": {
					"type": "number",
					"description": "The number of lines to keep when truncating tool output."
				},
				"enableMessageBusIntegration": {
					"type": "boolean",
					"description": "Enable policy-based tool confirmation via message bus integration. When enabled, tools automatically respect policy engine decisions (ALLOW/DENY/ASK_USER) without requiring individual tool implementations."
				},
				"enableHooks": {
					"type": "boolean",
					"description": "Enable the hooks system for intercepting and customizing Gemini CLI behavior. When enabled, hooks configured in settings will execute at appropriate lifecycle events (BeforeTool, AfterTool, BeforeModel, etc.). Requires MessageBus integration."
				}
			}
		},
		"mcp": {
			"type": "object",
			"properties": {
				"serverCommand": {
					"type": "string",
					"description": "Command to start an MCP server."
				},
				"allowed": {
					"type": "array",
					"description": "A list of MCP servers to allow.",
					"items": {
						"type": "string"
					}
				},
				"excluded": {
					"type": "array",
					"description": "A list of MCP servers to exclude.",
					"items": {
						"type": "string"
					}
				}
			}
		},
		"useSmartEdit": {
			"type": "boolean",
			"description": "Enable the smart-edit tool instead of the replace tool."
		},
		"useWriteTodos": {
			"type": "boolean",
			"description": "Enable the write_todos_list tool."
		},
		"security": {
			"type": "object",
			"properties": {
				"disableYoloMode": {
					"type": "boolean",
					"description": "Disable YOLO mode, even if enabled by a flag."
				},
				"folderTrust": {
					"type": "object",
					"properties": {
						"enabled": {
							"type": "boolean",
							"description": "Setting to track whether Folder trust is enabled."
						}
					}
				},
				"auth": {
					"type": "object",
					"properties": {
						"selectedType": {
							"type": "string",
							"description": "The currently selected authentication type."
						},
						"enforcedType": {
							"type": "string",
							"description": "The required auth type. If this does not match the selected auth type, the user will be prompted to re-authenticate."
						},
						"useExternal": {
							"type": "boolean",
							"description": "Whether to use an external authentication flow."
						}
					}
				}
			}
		},
		"advanced": {
			"type": "object",
			"properties": {
				"autoConfigureMemory": {
					"type": "boolean",
					"description": "Automatically configure Node.js memory limits"
				},
				"dnsResolutionOrder": {
					"type": "string",
					"description": "The DNS resolution order."
				},
				"excludedEnvVars": {
					"type": "array",
					"description": "Environment variables to exclude from project context.",
					"items": {
						"type": "string"
					}
				},
				"bugCommand": {
					"$ref": "#/definitions/BugCommandSettings",
					"description": "Configuration for the bug report command."
				}
			}
		},
		"experimental": {
			"type": "object",
			"properties": {
				"extensionManagement": {
					"type": "boolean",
					"description": "Enable extension management features."
				},
				"extensionReloading": {
					"type": "boolean",
					"description": "Enables extension loading/unloading within the CLI session."
				},
				"useModelRouter": {
					"type": "boolean",
					"description": "Enable model routing to route requests to the best model based on complexity."
				},
				"codebaseInvestigatorSettings": {
					"type": "object",
					"properties": {
						"enabled": {
							"type": "boolean",
							"description": "Enable the Codebase Investigator agent."
						},
						"maxNumTurns": {
							"type": "number",
							"description": "Maximum number of turns for the Codebase Investigator agent."
						},
						"maxTimeMinutes": {
							"type": "number",
							"description": "Maximum time for the Codebase Investigator agent (in minutes)."
						},
						"thinkingBudget": {
							"type": "number",
							"description": "The thinking budget for the Codebase Investigator agent."
						},
						"model": {
							"type": "string",
							"description": "The model to use for the Codebase Investigator agent."
						}
					}
				}
			}
		},
		"extensions": {
			"type": "object",
			"properties": {
				"disabled": {
					"type": "array",
					"description": "List of disabled extensions.",
					"items": {
						"type": "string"
					}
				},
				"workspacesWithMigrationNudge": {
					"type": "array",
					"description": "List of workspaces for which the migration nudge has been shown.",
					"items": {
						"type": "string"
					}
				}
			}
		},
		"hooks": {
			"type": "object",
			"description": "Hook configurations for intercepting and customizing agent behavior."
		}
	},
	"definitions": {
		"MCPServerConfig": {
			"type": "object",
			"description": "Definition of a Model Context Protocol (MCP) server configuration.",
			"additionalProperties": false,
			"properties": {
				"command": {
					"type": "string",
					"description": "Executable invoked for stdio transport."
				},
				"args": {
					"type": "array",
					"description": "Command-line arguments for the stdio transport command.",
					"items": {
						"type": "string"
					}
				},
				"env": {
					"type": "object",
					"description": "Environment variables to set for the server process.",
					"additionalProperties": {
						"type": "string"
					}
				},
				"cwd": {
					"type": "string",
					"description": "Working directory for the server process."
				},
				"url": {
					"type": "string",
					"description": "SSE transport URL."
				},
				"httpUrl": {
					"type": "string",
					"description": "Streaming HTTP transport URL."
				},
				"headers": {
					"type": "object",
					"description": "Additional HTTP headers sent to the server.",
					"additionalProperties": {
						"type": "string"
					}
				},
				"tcp": {
					"type": "string",
					"description": "TCP address for websocket transport."
				},
				"timeout": {
					"type": "number",
					"description": "Timeout in milliseconds for MCP requests."
				},
				"trust": {
					"type": "boolean",
					"description": "Marks the server as trusted. Trusted servers may gain additional capabilities."
				},
				"description": {
					"type": "string",
					"description": "Human-readable description of the server."
				},
				"includeTools": {
					"type": "array",
					"description": "Subset of tools that should be enabled for this server. When omitted all tools are enabled.",
					"items": {
						"type": "string"
					}
				},
				"excludeTools": {
					"type": "array",
					"description": "Tools that should be disabled for this server even if exposed.",
					"items": {
						"type": "string"
					}
				},
				"extension": {
					"type": "object",
					"description": "Metadata describing the Gemini CLI extension that owns this MCP server.",
					"additionalProperties": {
						"type": ["string", "boolean", "number"]
					}
				},
				"oauth": {
					"type": "object",
					"description": "OAuth configuration for authenticating with the server.",
					"additionalProperties": true
				},
				"authProviderType": {
					"type": "string",
					"description": "Authentication provider used for acquiring credentials (for example `dynamic_discovery`).",
					"enum": [
						"dynamic_discovery",
						"google_credentials",
						"service_account_impersonation"
					]
				},
				"targetAudience": {
					"type": "string",
					"description": "OAuth target audience (CLIENT_ID.apps.googleusercontent.com)."
				},
				"targetServiceAccount": {
					"type": "string",
					"description": "Service account email to impersonate (name@project.iam.gserviceaccount.com)."
				}
			}
		},
		"TelemetrySettings": {
			"type": "object",
			"description": "Telemetry configuration for Gemini CLI.",
			"additionalProperties": false,
			"properties": {
				"enabled": {
					"type": "boolean",
					"description": "Enables telemetry emission."
				},
				"target": {
					"type": "string",
					"description": "Telemetry destination (for example `stderr`, `stdout`, or `otlp`)."
				},
				"otlpEndpoint": {
					"type": "string",
					"description": "Endpoint for OTLP exporters."
				},
				"otlpProtocol": {
					"type": "string",
					"description": "Protocol for OTLP exporters.",
					"enum": ["grpc", "http"]
				},
				"logPrompts": {
					"type": "boolean",
					"description": "Whether prompts are logged in telemetry payloads."
				},
				"outfile": {
					"type": "string",
					"description": "File path for writing telemetry output."
				},
				"useCollector": {
					"type": "boolean",
					"description": "Whether to forward telemetry to an OTLP collector."
				}
			}
		},
		"BugCommandSettings": {
			"type": "object",
			"description": "Configuration for the bug report helper command.",
			"additionalProperties": false,
			"properties": {
				"urlTemplate": {
					"type": "string",
					"description": "Template used to open a bug report URL. Variables in the template are populated at runtime."
				}
			},
			"required": ["urlTemplate"]
		},
		"SummarizeToolOutputSettings": {
			"type": "object",
			"description": "Controls summarization behavior for individual tools. All properties are optional.",
			"additionalProperties": false,
			"properties": {
				"tokenBudget": {
					"type": "number",
					"description": "Maximum number of tokens used when summarizing tool output."
				}
			}
		},
		"CustomTheme": {
			"type": "object",
			"description": "Custom theme definition used for styling Gemini CLI output. Colors are provided as hex strings or named ANSI colors.",
			"additionalProperties": false,
			"properties": {
				"type": {
					"type": "string",
					"enum": ["custom"],
					"default": "custom"
				},
				"name": {
					"type": "string",
					"description": "Theme display name."
				},
				"text": {
					"type": "object",
					"additionalProperties": false,
					"properties": {
						"primary": {
							"type": "string"
						},
						"secondary": {
							"type": "string"
						},
						"link": {
							"type": "string"
						},
						"accent": {
							"type": "string"
						}
					}
				},
				"background": {
					"type": "object",
					"additionalProperties": false,
					"properties": {
						"primary": {
							"type": "string"
						},
						"diff": {
							"type": "object",
							"additionalProperties": false,
							"properties": {
								"added": {
									"type": "string"
								},
								"removed": {
									"type": "string"
								}
							}
						}
					}
				},
				"border": {
					"type": "object",
					"additionalProperties": false,
					"properties": {
						"default": {
							"type": "string"
						},
						"focused": {
							"type": "string"
						}
					}
				},
				"ui": {
					"type": "object",
					"additionalProperties": false,
					"properties": {
						"comment": {
							"type": "string"
						},
						"symbol": {
							"type": "string"
						},
						"gradient": {
							"type": "array",
							"items": {
								"type": "string"
							}
						}
					}
				},
				"status": {
					"type": "object",
					"additionalProperties": false,
					"properties": {
						"error": {
							"type": "string"
						},
						"success": {
							"type": "string"
						},
						"warning": {
							"type": "string"
						}
					}
				},
				"Background": {
					"type": "string"
				},
				"Foreground": {
					"type": "string"
				},
				"LightBlue": {
					"type": "string"
				},
				"AccentBlue": {
					"type": "string"
				},
				"AccentPurple": {
					"type": "string"
				},
				"AccentCyan": {
					"type": "string"
				},
				"AccentGreen": {
					"type": "string"
				},
				"AccentYellow": {
					"type": "string"
				},
				"AccentRed": {
					"type": "string"
				},
				"DiffAdded": {
					"type": "string"
				},
				"DiffRemoved": {
					"type": "string"
				},
				"Comment": {
					"type": "string"
				},
				"Gray": {
					"type": "string"
				},
				"DarkGray": {
					"type": "string"
				},
				"GradientColors": {
					"type": "array",
					"items": {
						"type": "string"
					}
				}
			},
			"required": ["type", "name"]
		},
		"StringOrStringArray": {
			"description": "Accepts either a single string or an array of strings.",
			"anyOf": [
				{
					"type": "string"
				},
				{
					"type": "array",
					"items": {
						"type": "string"
					}
				}
			]
		},
		"BooleanOrString": {
			"description": "Accepts either a boolean flag or a string command name.",
			"anyOf": [
				{
					"type": "boolean"
				},
				{
					"type": "string"
				}
			]
		}
	}
}
